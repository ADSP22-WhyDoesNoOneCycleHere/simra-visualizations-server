<?xml version="1.0" encoding="utf-8"?>
<Map srs="+init=epsg:3857">
	<Style name="legs" filter-mode="first">
		<Rule>
			<LineSymbolizer stroke="[color]" stroke-width="3.0"/>
		</Rule>
	</Style>
	<Layer name="legs" srs="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs">
		<StyleName>legs</StyleName>
		<Datasource>
			<Parameter name="type">postgis</Parameter>
			<Parameter name="host">localhost</Parameter>
			<Parameter name="dbname">simra</Parameter>
			<Parameter name="user">simra</Parameter>
			<Parameter name="password">simra12345simra</Parameter>
			<!-- Scary Incidents are counted twice. ST_Length(geom::geography) returns the length in meters.  -->
			<Parameter name="table">(
                select
                    *,
                    concat('hsl(', ROUND((1.0 - LEAST((("normalIncidentCount" + 2 * "scaryIncidentCount") / ST_Length(geom::geography) * 1000) / 25, 1)) * 120.0), ' , 69%, 50%)') as color
                from public."SimRaAPI_osmwayslegs"
                where count > 0
            ) t</Parameter>
		</Datasource>
	</Layer>
</Map>

